<div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 sticky top-0">
    <header class="mb-4">
        <h2 appText="h3" class="mb-1 text-gray-900">Resolución de Denuncia</h2>
        <p appText="body" class="text-gray-500">Actualiza el estado y adjunta evidencia visual.</p>
    </header>

    <form [formGroup]="form" (ngSubmit)="marcarResuelta()" class="space-y-5">

        <div>
            <app-select id="estado" label="Nuevo Estado de la Denuncia" placeholder="Seleccione estado..."
                [options]="estadoOptions" [formControl]="form.controls.estado">
            </app-select>

            @if (form.controls.estado.touched && form.controls.estado.hasError('required')) {
            <p class="mt-1 text-xs text-red-600 flex items-center gap-1">
                El estado es requerido
            </p>
            }
        </div>

        <div>
            <label appText="label" for="evidenciaInput" class="mb-2 block">
                Evidencia Fotográfica <span class="text-gray-400 font-normal">(Opcional)</span>
            </label>

            <div class="relative group">
                <app-file-upload (filesChange)="evidencias.set($event)" (uploadError)="handleUploadError($event)">
                </app-file-upload>

            </div>
        </div>

        <div>
            <label appText="label" for="comentarios">Comentarios del Operador</label>
            <app-input id="comentarios" placeholder="Justifique el cambio de estado..."
                [formControl]="form.controls.comentarios" [multiline]="true" [rows]="3" [icon]="faComment">
            </app-input>
            <app-input-error [control]="form.get('comentarios')"></app-input-error>
        </div>

        <app-submit-button label="Actualizar Denuncia" [icon]="faSave" [isLoading]="isSubmitting()"
            [isDisabled]="form.invalid || isSubmitting()" type="submit" class="w-full mt-4">
        </app-submit-button>
    </form>
</div>
