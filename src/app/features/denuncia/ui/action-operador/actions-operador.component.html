<div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 sticky top-0">
    <header class="mb-4">
        <h2 appText="h3" class="mb-1 text-gray-900">Resolución de Denuncia</h2>
    </header>

    <form [formGroup]="form" (ngSubmit)="resolverDenunciaPorOperador()" class="space-y-5">
        @if(isEnProceso()){
        <div>
            <div class="relative group">
                <app-file-upload [uploadFn]="uploadEvidenceStrategy()" (fileUploaded)="agregarEvidencia($event)"
                    (uploadError)="handleUploadError($event)">
                </app-file-upload>

            </div>
        </div>

        <div>
            <label appText="label" for="comentarios">Comentarios del Operador</label>
            <app-input id="comentarios" placeholder="Justifique el cambio de estado..."
                [formControl]="form.controls.comentarioResolucion" [multiline]="true" [rows]="3" [icon]="faComment"
                [maxlength]="1000">
            </app-input>
            <div class="mt-1 text-xs text-gray-500 flex items-center justify-between">
                <div>Requerido. 10–500 caracteres.</div>
                <div class="text-gray-400">{{ (form.get('comentarioResolucion')?.value?.length || 0) }}/500
                </div>
            </div>
        </div>
        }
        <div class="flex gap-3">
            @if(canIniciar()){
            <div class="w-full space-y-2">
                <span class="block text-xs text-slate-500 text-center font-medium">
                    <fa-icon [icon]="faInfoCircle" class="mr-1"></fa-icon>
                    Presione el botón para empezar a trabajar en la denuncia.
                </span>
                <app-submit-button label="Iniciar proceso" [icon]="faPlay" [isLoading]="isLoading()"
                    [isDisabled]="isLoading()" btnType="button" (click)="iniciarDenunciaPorOperador()"
                    (keydown.enter)="iniciarDenunciaPorOperador()" class="w-full">
                </app-submit-button>
            </div>
            }

            @if(isEnProceso()){
            <app-submit-button label="Resolver denuncia" [icon]="faCheck" [isLoading]="isLoading()"
                [isDisabled]="form.invalid || isLoading()" btnType="submit" class="w-full">
            </app-submit-button>
            }
        </div>
    </form>
</div>
